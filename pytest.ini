[pytest]
python_files = test_*.py
python_classes = Test*
python_functions = test_*

testpaths = tests

# Async configuration
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function

# Test markers
markers =
    llm_test: Tests that involve LLM interactions
    qdrant_test: Tests that involve Qdrant vector database
    integration: Integration tests requiring multiple services
    smoke: Quick smoke tests for basic functionality
    regression: Full regression test suite
    slow: Tests that take longer to execute
    philosophy_prompt: Tests for specific philosophy prompts
    immersive_mode: Tests for philosopher impersonation mode
    endpoint_test: Tests for specific API endpoints
    payment: Tests for payment system functionality
    unit: Unit tests for individual components
    e2e: End-to-end tests

# Test execution options
addopts =
    -v
    --strict-markers
    --tb=short
    -p no:cacheprovider
    --asyncio-mode=auto

# Warning filters
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:transformers.*
    ignore::FutureWarning:transformers.*
    ignore::UserWarning:torch.*
    ignore::FutureWarning:torch.*
    ignore::RuntimeWarning:asyncio.*
    ignore::RuntimeWarning:pytest_asyncio.*
    ignore:.*was never awaited:RuntimeWarning
    ignore:.*coroutine.*was never awaited:RuntimeWarning
    ignore:.*builtin type.*:DeprecationWarning
    ignore:.*datetime.datetime.utcnow.*:DeprecationWarning
    ignore:.*pkg_resources.*:DeprecationWarning
    ignore:.*distutils.*:DeprecationWarning
    ignore:.*imp module.*:DeprecationWarning
    ignore:.*unclosed.*:ResourceWarning
    ignore:.*unclosed event loop.*:ResourceWarning
    ignore:.*There is no current event loop.*:DeprecationWarning
    ignore:.*Pydantic.*:UserWarning
    ignore:.*pydantic.*:UserWarning
    ignore:.*telemetry.*:UserWarning
    ignore:.*tracing.*:UserWarning
    ignore::pytest.PytestUnraisableExceptionWarning
    # Pydantic v2 deprecation warnings
    ignore:Support for class-based.*config.*is deprecated:DeprecationWarning:pydantic.*
    ignore:Using extra keyword arguments on.*Field.*is deprecated:DeprecationWarning:pydantic.*
    ignore::pydantic.warnings.PydanticDeprecatedSince20
    # Pydantic settings warnings
    ignore:directory.*does not exist:UserWarning:pydantic_settings.*
    # Builtin type warnings from SWIG/C extensions
    ignore:builtin type.*has no __module__ attribute:DeprecationWarning
    # Additional datetime warnings
    ignore:datetime.datetime.utcnow.*is deprecated:DeprecationWarning
    # Async/coroutine warnings
    ignore:coroutine.*was never awaited:RuntimeWarning
    ignore:.*never awaited.*:RuntimeWarning
    # I/O operation warnings from telemetry/tracing
    ignore:.*I/O operation on closed.*:ResourceWarning
    ignore:.*enable_resource_warnings.*:ResourceWarning
    # SQLAlchemy warnings (Task 7.1)
    ignore::DeprecationWarning:sqlalchemy.*
    # httpx and async client warnings
    ignore::ResourceWarning:httpx.*
    ignore::DeprecationWarning:httpx.*
    # Stripe library warnings
    ignore::DeprecationWarning:stripe.*
    ignore::UserWarning:stripe.*
    # pytest-asyncio specific warnings
    ignore::DeprecationWarning:pytest_asyncio.*
    ignore:.*event loop.*:DeprecationWarning
    # Test utility warnings
    ignore::UserWarning:tests.*
    ignore::DeprecationWarning:unittest.mock.*

# Logging configuration
log_cli = false
log_cli_level = ERROR
log_cli_format = %(asctime)s [%(levelname)s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S
